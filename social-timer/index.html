<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Social Pomodoro | Join or Create</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@400;500&display=swap" rel="stylesheet">
  <style>
    body {
      margin: 0;
      padding: 0;
      background-color: #f5f5f3;
      font-family: 'Inter', sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
    }

    .title {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      font-weight: 600;
      color: #222;
      margin-bottom: 1rem;
    }

    .container {
      background: white;
      padding: 2rem;
      border-radius: 20px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
      text-align: center;
      max-width: 420px;
      width: 90%;
    }

    h1 {
      font-size: 1.25rem;
      color: #444;
      margin-bottom: 0.75rem;
    }

    input[type="text"] {
      width: 100%;
      padding: 0.75rem;
      font-size: 1rem;
      border-radius: 10px;
      border: 1px solid #ccc;
      margin-bottom: 1rem;
      box-sizing: border-box;
    }

    .emoji-grid {
      display: grid;
      grid-template-columns: repeat(5, 1fr);
      gap: 0.5rem;
      justify-items: center;
      margin-bottom: 1rem;
    }

    .emoji {
      font-size: 1.5rem;
      padding: 0.5rem;
      border-radius: 10px;
      background-color: #f0f0f0;
      cursor: pointer;
    }

    .emoji.selected {
      background-color: #c3c3c3;
    }

    .emoji-label {
      font-size: 0.85rem;
      color: #666;
      margin-bottom: 0.5rem;
    }

    button {
      width: 48%;
      padding: 0.75rem;
      font-size: 1rem;
      border: none;
      border-radius: 10px;
      cursor: pointer;
      margin-top: 0.5rem;
      transition: background-color 0.3s ease;
    }

         button:first-child {
        background-color: #e0e0e0; /* soft gray for Join */
        color: #333;
      }
      
      button:first-child:hover {
        background-color: #d0d0d0;
      }

    button:last-child {
      background-color: #f9e0dc; /* soft coral for Create */
      color: #5f2a2a;
    }

    button:last-child:hover {
      background-color: #f2cdc8;
    }

    #linkText {
      margin-top: 1rem;
      font-size: 0.9rem;
      color: #555;
    }

    .description {
      font-size: 0.85rem;
      color: #777;
      margin-top: -0.5rem;
      margin-bottom: 1.25rem;
    }
  </style>
</head>
<body>
  <div class="title">Social Pomodoro Timer</div>
  <div class="container">
    <h1>🌱 Join or Create a Session</h1>
    <p class="description">Create a unique session name (e.g. deep-club or design-sprint)</p>
    <input type="text" id="sessionInput" placeholder="e.g. focus-group" />

    <div class="emoji-label">Choose your avatar:</div>
    <div class="emoji-grid" id="emojiGrid"></div>

    <div style="display: flex; justify-content: space-between;">
      <button onclick="joinSession()">Join</button>
      <button onclick="createSession()">Create</button>
    </div>

    <div id="linkText"></div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyAW3sw__h-YyGOBowZULt2iZ59CP8KkU34",
      authDomain: "social-timer-a2315.firebaseapp.com",
      projectId: "social-timer-a2315",
      storageBucket: "social-timer-a2315.appspot.com",
      messagingSenderId: "68840014890",
      appId: "1:68840014890:web:ac1b634ab00b41622eef53"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    const emojis = ["🐢", "🦊", "🐰", "🐸", "🐼", "🐶", "🦁", "🐻", "🐨", "🐱"];
    let selectedEmoji = emojis[0];

    const grid = document.getElementById("emojiGrid");
    emojis.forEach((emoji) => {
      const span = document.createElement("span");
      span.textContent = emoji;
      span.className = "emoji";
      if (emoji === selectedEmoji) span.classList.add("selected");
      span.onclick = () => {
        selectedEmoji = emoji;
        document.querySelectorAll(".emoji").forEach(el => el.classList.remove("selected"));
        span.classList.add("selected");
      };
      grid.appendChild(span);
    });

    async function joinSession() {
      const name = document.getElementById("sessionInput").value.trim();
      if (!name) {
        alert("Please enter a session name.");
        return;
      }

      const doc = await db.collection("sessions").doc(name).get();
      if (!doc.exists) {
        alert("This session does not exist.");
        return;
      }

      localStorage.setItem("selectedEmoji", selectedEmoji);
      window.location.href = `/social-timer/?session=${encodeURIComponent(name)}`;
    }

    function createSession() {
      const name = document.getElementById("sessionInput").value.trim();
      if (!name) {
        alert("Please enter a session name.");
        return;
      }
      const url = `${window.location.origin}/social-timer/?session=${encodeURIComponent(name)}`;
      document.getElementById("linkText").textContent = `🔗 ${url}`;
      navigator.clipboard.writeText(url).then(() => {
        alert("Link copied to clipboard!");
      });
    }
  </script>
</body>
</html>



